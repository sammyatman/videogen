<!--
  GenAI Media Showdown – Images + Videos (reference centred)
  ==========================================================
  Drop this file at the root of a GitHub repository (e.g. main branch)
  and enable GitHub Pages → Deploy from branch.
  Put your media under an assets/ folder (or anywhere you like) and
  fill in the examples array below with your own prompts, model names
  and file paths ( .jpg / .png / .mp4 / .webm …).
  One self-contained file – no build step required.
-->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>VideoGen Models @ SPC VideoAI</title>

<!-- ----------- STYLES ----------- -->
<style>
:root{
  --bg:#0f0f0f;--bg-light:#1a1a1a;--fg:#fff;--fg-muted:#a0a0a0;
  --surface:#262626;--surface-hover:#333;--border:#404040;
  --accent:#3b82f6;--accent-hover:#2563eb;--success:#10b981;
  --warning:#f59e0b;--shadow:rgba(0,0,0,.3);
  --gradient:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
  font-family:'Inter',-apple-system,BlinkMacSystemFont,system-ui,sans-serif
}
*,*::before,*::after{box-sizing:border-box}
html{scroll-behavior:smooth}
body{margin:0;background:var(--bg);color:var(--fg);line-height:1.6}

header{
  background:var(--surface);backdrop-filter:blur(10px);position:sticky;top:0;
  z-index:100;border-bottom:1px solid var(--border);padding:1rem 2rem;
  box-shadow:0 2px 20px var(--shadow)
}
.header-content{max-width:1400px;margin:0 auto}
header h1{
  margin:0 0 1rem;font-size:2rem;font-weight:700;
  background:var(--gradient);-webkit-background-clip:text;
  -webkit-text-fill-color:transparent;background-clip:text
}

/* ───── Tab Navigation ───── */
.tab-container{margin-bottom:2rem}
.tab-nav{
  display:flex;gap:.5rem;margin-bottom:1.5rem;border-bottom:1px solid var(--border);
  padding-bottom:0
}
.tab-button{
  padding:.75rem 1.5rem;background:transparent;border:none;color:var(--fg-muted);
  font-size:.9rem;font-weight:500;cursor:pointer;transition:.2s;
  border-bottom:2px solid transparent;position:relative
}
.tab-button:hover{color:var(--fg);background:var(--bg-light)}
.tab-button.active{
  color:var(--accent);border-bottom-color:var(--accent);
  background:var(--bg-light)
}
.tab-badge{
  display:inline-block;background:var(--surface);color:var(--fg-muted);
  font-size:.7rem;padding:.2rem .4rem;border-radius:8px;margin-left:.5rem;
  font-weight:600
}
.tab-button.active .tab-badge{background:var(--accent);color:white}

.search-container{margin-bottom:1rem;position:relative}
#searchInput{
  width:100%;max-width:400px;padding:.75rem 1rem .75rem 2.5rem;
  background:var(--bg-light);border:1px solid var(--border);border-radius:12px;
  color:var(--fg);font-size:.9rem;transition:.2s
}
#searchInput:focus{outline:none;border-color:var(--accent);
  box-shadow:0 0 0 3px rgba(59,130,246,.1)}
.search-icon{position:absolute;left:.75rem;top:50%;
  transform:translateY(-50%);color:var(--fg-muted);pointer-events:none}

nav{display:flex;flex-wrap:wrap;gap:.5rem;max-height:200px;overflow-y:auto}
nav a{
  padding:.5rem 1rem;background:var(--bg-light);
  border:1px solid var(--border);border-radius:8px;text-decoration:none;
  color:var(--fg);font-size:.85rem;white-space:nowrap;transition:.2s;
  position:relative;overflow:hidden
}
nav a:hover{background:var(--surface-hover);border-color:var(--accent);
  transform:translateY(-1px)}
nav a.hidden{display:none}

main{max-width:1400px;margin:0 auto;padding:2rem}

.stats{display:flex;gap:2rem;margin-bottom:2rem;flex-wrap:wrap}
.stat{
  background:var(--surface);border:1px solid var(--border);
  border-radius:12px;padding:1rem;text-align:center;min-width:120px
}
.stat-number{font-size:1.5rem;font-weight:700;color:var(--accent)}
.stat-label{font-size:.8rem;color:var(--fg-muted);text-transform:uppercase}

/* ───── Model Scoring Section ───── */
.scoring-section{
  background:var(--surface);border:1px solid var(--border);
  border-radius:16px;padding:2rem;margin-bottom:3rem;
  box-shadow:0 4px 20px var(--shadow)
}
.scoring-title{
  font-size:1.5rem;font-weight:600;margin:0 0 1.5rem;
  color:var(--fg);text-align:center
}
.scoring-subtitle{
  color:var(--fg-muted);text-align:center;margin-bottom:2rem;
  font-size:.9rem
}

.scoring-table{
  overflow-x:auto;border-radius:12px;
  background:var(--bg-light);border:1px solid var(--border)
}
.scoring-table table{
  width:100%;border-collapse:collapse;min-width:800px
}
.scoring-table th,.scoring-table td{
  padding:1rem;text-align:center;border-bottom:1px solid var(--border);
  width:14.28%;position:relative
}
.scoring-table th:first-child,.scoring-table td:first-child{
  width:20%;text-align:left
}
.scoring-table th:not(:first-child),.scoring-table td:not(:first-child){
  width:13.33%
}
.scoring-table th{
  background:var(--surface);color:var(--fg);font-weight:600;
  font-size:.85rem;text-transform:uppercase;letter-spacing:.5px;
  cursor:pointer;transition:.2s;user-select:none
}
.scoring-table th:hover{
  background:var(--surface-hover);color:var(--accent)
}
.scoring-table th.sortable{position:relative}
.sort-indicator{
  position:absolute;right:.5rem;top:50%;transform:translateY(-50%);
  font-size:.7rem;opacity:.5;transition:.2s
}
.scoring-table th.sort-asc .sort-indicator{opacity:1;color:var(--accent)}
.scoring-table th.sort-desc .sort-indicator{opacity:1;color:var(--accent);transform:translateY(-50%) rotate(180deg)}
.scoring-table td{color:var(--fg);font-size:.9rem}
.scoring-table tr:last-child td{border-bottom:none}
.scoring-table tr:hover{background:rgba(59,130,246,.05)}

.model-name{font-weight:600;color:var(--accent)}
.score-cell{font-weight:500;position:relative}
.score-excellent{color:#10b981}
.score-good{color:#3b82f6}
.score-average{color:#f59e0b}
.score-poor{color:#ef4444}

.average-cell{
  font-weight:700;font-size:1rem;
  background:rgba(59,130,246,.1);border-radius:8px
}

.score-bar{
  width:100%;height:4px;background:var(--border);
  border-radius:2px;margin-top:.5rem;overflow:hidden
}
.score-fill{
  height:100%;border-radius:2px;transition:.3s ease
}
.score-fill.excellent{background:#10b981}
.score-fill.good{background:#3b82f6}
.score-fill.average{background:#f59e0b}
.score-fill.poor{background:#ef4444}

/* ───── End Scoring Section ───── */

section{margin-bottom:4rem;opacity:0;transform:translateY(20px);
         animation:fadeInUp .6s ease forwards}
@keyframes fadeInUp{to{opacity:1;transform:translateY(0)}}
section.hidden{display:none}

h2{margin:0 0 1.5rem;font-size:1.5rem;font-weight:600;
    scroll-margin-top:8rem;color:var(--fg);position:relative;padding-bottom:.5rem}
h2::after{
  content:'';position:absolute;bottom:0;left:0;width:60px;height:2px;
  background:var(--gradient);border-radius:1px
}

/* grid with reference first & centred for I2V, regular grid for T2V */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(280px,1fr));
  gap:1.5rem
}
.grid.i2v figure.reference{
  grid-column:1 / -1;          /* span the whole row */
  justify-self:center;         /* centre horizontally */
  max-width:380px;             /* optional: limit width */
}

figure{
  margin:0;background:var(--surface);border:1px solid var(--border);
  border-radius:16px;overflow:hidden;box-shadow:0 4px 20px var(--shadow);
  display:flex;flex-direction:column;transition:.3s;cursor:pointer;position:relative;
  height:100%
}
figure:hover{transform:translateY(-4px);box-shadow:0 8px 40px var(--shadow);
             border-color:var(--accent)}

.image-container{
  position:relative;aspect-ratio:1;overflow:hidden;
  background:var(--bg-light);flex-shrink:0
}

/* ───── Carousel Styles ───── */
.carousel-container{position:relative;width:100%;height:100%}
.carousel-slides{
  position:relative;width:100%;height:100%;overflow:hidden;
  cursor:pointer
}
.carousel-slide{
  position:absolute;top:0;left:0;width:100%;height:100%;
  opacity:0;transition:opacity .3s ease;pointer-events:none;
  display:flex;align-items:center;justify-content:center
}
.carousel-slide.active{opacity:1;pointer-events:auto}

.carousel-nav{
  position:absolute;bottom:8px;left:50%;transform:translateX(-50%);
  display:flex;gap:6px;z-index:20;
  pointer-events:auto
}
.carousel-dot{
  width:8px;height:8px;border-radius:50%;background:rgba(255,255,255,.4);
  cursor:pointer;transition:.2s;pointer-events:auto
}
.carousel-dot.active{background:var(--accent)}

.carousel-arrows{
  position:absolute;top:50%;transform:translateY(-50%);
  width:100%;display:flex;justify-content:space-between;
  pointer-events:none;z-index:20
}
.carousel-arrow{
  width:32px;height:32px;background:rgba(0,0,0,.7);color:white;
  border:none;border-radius:50%;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  font-size:14px;transition:.2s;pointer-events:auto;
  margin:0 8px
}
.carousel-arrow:hover{background:rgba(0,0,0,.9);transform:scale(1.1)}
.carousel-arrow:disabled{opacity:.3;cursor:not-allowed}

figure img,figure video{
  display:block;width:100%;height:100%;object-fit:cover;transition:.3s
}
figure:hover img,figure:hover video{transform:scale(1.05)}

.loading-placeholder{
  display:flex;align-items:center;justify-content:center;height:100%;
  color:var(--fg-muted);font-size:.9rem
}
.loading-spinner{
  width:24px;height:24px;border:2px solid var(--border);
  border-top:2px solid var(--accent);border-radius:50%;
  animation:spin 1s linear infinite;margin-right:.5rem}
@keyframes spin{0%{transform:rotate(0)}100%{transform:rotate(360deg)}}
.error-placeholder{
  background:rgba(239,68,68,.1);color:#ef4444;
  border:1px solid rgba(239,68,68,.2)
}

figcaption{
  padding:1rem;font-size:.9rem;font-weight:600;text-align:center;
  border-top:1px solid var(--border);background:var(--surface);
  flex-shrink:0
}

/* ───── Card Scoring ───── */
.card-scoring{
  padding:0.75rem 1rem;background:var(--bg-light);
  border-top:1px solid var(--border);font-size:.85rem;
  flex-grow:1;display:flex;flex-direction:column;justify-content:flex-start
}
.card-scoring-placeholder{
  padding:0.75rem 1rem;background:var(--bg-light);
  border-top:1px solid var(--border);font-size:.85rem;
  flex-grow:1;min-height:90px;opacity:0
}
.score-badge{
  display:inline-block;padding:.25rem .5rem;border-radius:12px;
  font-weight:600;font-size:.75rem;text-transform:uppercase;
  letter-spacing:.5px;margin-bottom:.5rem
}
.score-excellent{background:rgba(16,185,129,.2);color:#10b981}
.score-good{background:rgba(59,130,246,.2);color:#3b82f6}
.score-average{background:rgba(245,158,11,.2);color:#f59e0b}
.score-poor{background:rgba(239,68,68,.2);color:#ef4444}
.score-comment{color:var(--fg-muted);line-height:1.4;margin-bottom:.75rem}

/* ───── Collapsible Metrics Section ───── */
.metrics-toggle{
  display:flex;align-items:center;justify-content:space-between;
  cursor:pointer;padding:.5rem 0;border-top:1px solid var(--border);
  margin-top:.5rem;transition:.2s
}
.metrics-toggle:hover{color:var(--accent)}
.metrics-toggle-text{
  display:flex;align-items:center;gap:.5rem;font-size:.8rem;
  font-weight:500;color:var(--fg-muted)
}
.bar-chart-icon{
  width:16px;height:16px;display:flex;align-items:flex-end;gap:2px
}
.bar{
  width:2px;background:var(--accent);border-radius:1px;transition:.2s
}
.bar:nth-child(1){height:6px}
.bar:nth-child(2){height:10px}
.bar:nth-child(3){height:8px}
.bar:nth-child(4){height:12px}
.bar:nth-child(5){height:4px}

.toggle-arrow{
  font-size:1rem;transition:transform .2s ease;color:var(--fg-muted)
}
.metrics-toggle.expanded .toggle-arrow{transform:rotate(180deg)}

.metrics-details{
  max-height:0;overflow:hidden;transition:max-height .3s ease-out;
  background:var(--surface);border-radius:8px;margin-top:.5rem
}
.metrics-details.expanded{max-height:300px;padding:.75rem}

.metric-item{
  display:flex;justify-content:space-between;align-items:center;
  margin-bottom:.5rem;font-size:.75rem
}
.metric-item:last-child{margin-bottom:0}
.metric-name{color:var(--fg);font-weight:500;text-transform:capitalize}
.metric-score{display:flex;align-items:center;gap:.5rem}
.metric-value{font-weight:600;min-width:24px;text-align:right}
.metric-bar{
  width:60px;height:4px;background:var(--border);border-radius:2px;
  overflow:hidden;position:relative
}
.metric-bar-fill{
  height:100%;border-radius:2px;transition:.3s ease
}

/* ───────── Modal ───────── */
.modal{
  display:none;position:fixed;z-index:1000;left:0;top:0;width:100%;height:100%;
  background:rgba(0,0,0,.9);backdrop-filter:blur(10px)
}
.modal.active{display:flex;align-items:center;justify-content:center;
              animation:fadeIn .3s ease}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal-content{
  max-width:90vw;max-height:90vh;position:relative;
  animation:scaleIn .3s ease;background:transparent;
  display:flex;flex-direction:column;align-items:center
}
@keyframes scaleIn{from{transform:scale(.8)}to{transform:scale(1)}}

.modal-media-container{
  position:relative;width:80vw;max-width:90vw;max-height:80vh;
  display:flex;align-items:center;justify-content:center
}
.modal-media-container .carousel-slides{
  position:relative;width:100%;height:100%;min-height:400px;
  display:flex;align-items:center;justify-content:center
}

.modal-carousel-nav{
  position:absolute;bottom:-2rem;left:50%;transform:translateX(-50%);
  display:flex;gap:8px
}
.modal-carousel-dot{
  width:12px;height:12px;border-radius:50%;background:rgba(255,255,255,.4);
  cursor:pointer;transition:.2s
}
.modal-carousel-dot.active{background:var(--accent)}

.modal-carousel-arrows{
  position:absolute;top:50%;transform:translateY(-50%);
  width:calc(100% + 80px);left:-40px;
  display:flex;justify-content:space-between;pointer-events:none
}
.modal-carousel-arrow{
  width:40px;height:40px;background:rgba(0,0,0,.8);color:white;
  border:none;border-radius:50%;cursor:pointer;
  display:flex;align-items:center;justify-content:center;
  font-size:16px;transition:.2s;pointer-events:auto
}
.modal-carousel-arrow:hover{background:rgba(0,0,0,1);transform:scale(1.1)}
.modal-carousel-arrow:disabled{opacity:.3;cursor:not-allowed}

.modal-caption{
  position:absolute;bottom:-4rem;left:50%;transform:translateX(-50%);
  background:var(--surface);color:var(--fg);padding:.75rem 1.5rem;border-radius:8px;
  font-size:.9rem;white-space:nowrap;max-width:90vw;text-align:center
}
.close{
  position:absolute;top:-3rem;right:0;color:var(--fg);font-size:2rem;
  font-weight:bold;cursor:pointer;width:2.5rem;height:2.5rem;
  display:flex;align-items:center;justify-content:center;
  background:var(--surface);border-radius:50%;transition:.2s}
.close:hover{background:var(--surface-hover);transform:scale(1.1)}

.no-results{text-align:center;color:var(--fg-muted);font-size:1.1rem;
            margin:4rem 0;display:none}.no-results.visible{display:block}

/* ───── Tab Content ───── */
.tab-content{display:none}
.tab-content.active{display:block}

/* ───── Responsive ───── */
@media(max-width:768px){
  header{padding:1rem}
  header h1{font-size:1.5rem}
  main{padding:1rem}
  .grid{grid-template-columns:1fr;gap:1rem}
  .stats{justify-content:center}
  nav{max-height:150px}
  .scoring-section{padding:1rem}
  .scoring-table{font-size:.8rem}
  .scoring-table th,.scoring-table td{padding:.5rem .25rem}
  .scoring-table th{font-size:.7rem}
  .sort-indicator{right:.25rem;font-size:.6rem}
  .carousel-arrow{width:28px;height:28px;font-size:12px}
  .modal-carousel-arrow{width:36px;height:36px;font-size:14px}
  .metrics-details{max-height:250px}
  .metric-bar{width:40px}
  .tab-nav{flex-wrap:wrap}
  .tab-button{padding:.5rem 1rem;font-size:.8rem}
}
/* Accessibility */
@media(prefers-reduced-motion:reduce){
  *,*::before,*::after{animation-duration:0.01ms!important;
   animation-iteration-count:1!important;transition-duration:0.01ms!important}
  html{scroll-behavior:auto}
}
nav a:focus,figure:focus,#searchInput:focus,.tab-button:focus{
  outline:2px solid var(--accent);outline-offset:2px}
</style>
</head>
<body>
<header>
  <div class="header-content">
    <h1>VideoGen Models @ SPC VideoAI</h1>

    <!-- ───── Tab Navigation ───── -->
    <div class="tab-container">
      <div class="tab-nav">
        <button class="tab-button active" data-tab="i2v">
          Image-to-Video 
          <span class="tab-badge" id="i2vCount">0</span>
        </button>
        <button class="tab-button" data-tab="t2v">
          Text-to-Video 
          <span class="tab-badge" id="t2vCount">0</span>
        </button>
      </div>

      <div class="search-container">
        <div class="search-icon">🔍</div>
        <input id="searchInput" type="text" placeholder="Search prompts…" aria-label="Search prompts"/>
      </div>

      <nav id="nav" role="navigation" aria-label="Prompt navigation"></nav>
    </div>
  </div>
</header>

<main>
  <div class="stats">
    <div class="stat">
      <div class="stat-number" id="totalPrompts">0</div>
      <div class="stat-label">Prompts</div>
    </div>
    <div class="stat">
      <div class="stat-number" id="totalMedia">0</div>
      <div class="stat-label">Media</div>
    </div>
    <div class="stat">
      <div class="stat-number" id="totalModels">0</div>
      <div class="stat-label">Models</div>
    </div>
  </div>

  <!-- ───── Model Scoring Section ───── -->
  <div class="scoring-section">
    <h3 class="scoring-title">Model Performance Scores</h3>
    <p class="scoring-subtitle">Comparative evaluation across key video generation metrics (scored 1-10)</p>

    <div class="scoring-table">
      <table id="scoringTable">
        <thead>
          <tr>
            <th>Model</th>
            <th>Instruction Following</th>
            <th>Consistency</th>
            <th>Realism</th>
            <th>Animation Quality</th>
            <th>Creativity</th>
            <th>Average Score</th>
          </tr>
        </thead>
        <tbody id="scoringTableBody">
          <!-- Populated by JavaScript -->
        </tbody>
      </table>
    </div>
  </div>

  <!-- ───── Tab Contents ───── -->
  <div class="tab-content active" id="i2v-content">
    <div id="i2v-examples"></div>
    <div class="no-results" id="i2vNoResults">
      <div style="font-size:3rem;margin-bottom:1rem">🔍</div>
      <div>No I2V prompts match your search</div>
      <div style="font-size:.9rem;margin-top:.5rem;color:var(--fg-muted)">
        Try adjusting your search terms
      </div>
    </div>
  </div>

  <div class="tab-content" id="t2v-content">
    <div id="t2v-examples"></div>
    <div class="no-results" id="t2vNoResults">
      <div style="font-size:3rem;margin-bottom:1rem">🔍</div>
      <div>No T2V prompts match your search</div>
      <div style="font-size:.9rem;margin-top:.5rem;color:var(--fg-muted)">
        Try adjusting your search terms
      </div>
    </div>
  </div>
</main>

<!-- ───── Modal ───── -->
<div id="mediaModal" class="modal" role="dialog" aria-hidden="true">
  <div class="modal-content">
    <span class="close" aria-label="Close modal">×</span>
    <div class="modal-media-container">
      <div id="modalCarouselSlides" class="carousel-slides">
        <!-- Populated dynamically -->
      </div>
      <div class="modal-carousel-arrows">
        <button class="modal-carousel-arrow" id="modalPrevBtn">‹</button>
        <button class="modal-carousel-arrow" id="modalNextBtn">›</button>
      </div>
      <div class="modal-carousel-nav" id="modalCarouselNav">
        <!-- Populated dynamically -->
      </div>
    </div>
    <div class="modal-caption" id="modalCaption"></div>
  </div>
</div>

<!-- ----------- DATA + APP ----------- -->
<script>
/*───────────────────────────────────────────
 1) EDIT YOUR DATA BELOW
───────────────────────────────────────────*/

// Model scoring data (scores out of 10)
const modelScores = {
  "Veo 3": {
    instructionFollowing: 9.1,
    consistency: 8.85,
    realism: 9.05,
    animation: 8.85,
    creativity: 8.75
  },
  "Veo 2": {
    instructionFollowing: 8.1,
    consistency: 7.9,
    realism: 8.3,
    animation: 8.0,
    creativity: 7.8
  },
  "Sora": {
    instructionFollowing: 8.5,
    consistency: 8.3,
    realism: 8.7,
    animation: 8.4,
    creativity: 8.6
  },
  "HunYuan": {
    instructionFollowing: 7.8,
    consistency: 8.2,
    realism: 7.9,
    animation: 7.7,
    creativity: 8.1
  },
  "Wan 2.1": {
    instructionFollowing: 7.5,
    consistency: 7.8,
    realism: 7.6,
    animation: 7.4,
    creativity: 7.7
  },
  "Kling 1.6": {
    instructionFollowing: 7.9,
    consistency: 8.0,
    realism: 8.1,
    animation: 8.2,
    creativity: 7.8
  },
  "Kling 2.0": {
    instructionFollowing: 8.3,
    consistency: 8.4,
    realism: 8.5,
    animation: 8.6,
    creativity: 8.2
  },
  "FramePack + HunYuan": {
    instructionFollowing: 8.0,
    consistency: 8.5,
    realism: 8.1,
    animation: 7.9,
    creativity: 8.3
  },
  "CogVideoX 1.5": {
    instructionFollowing: 8.0,
    consistency: 8.5,
    realism: 8.1,
    animation: 7.9,
    creativity: 8.3
  },
};

// I2V Examples (Image-to-Video with reference images)
const i2vExamples = [
  {
    prompt:"Realistic woman in mid 40s walking through a city street in New York",
    images:[
      {
        model:"Reference Image",
        src:"examples/woman_40_walking_nyc/original.jpeg",
        score: "reference",
        comment: "Original reference image"
      },
      {
        model:"Veo 3",
        variants:[
          {src:"examples/woman_40_walking_nyc/veo3_1.mp4", label:"v1"},
          {src:"examples/woman_40_walking_nyc/veo3_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Outstanding realism and natural movement. Both versions capture the urban environment perfectly.",
        metrics: {
          instructionFollowing: 9.2,
          consistency: 8.9,
          realism: 9.3,
          animation: 9.0,
          creativity: 8.5
        }
      },
      {
        model:"Veo 2",
        variants:[
          {src:"examples/woman_40_walking_nyc/veo2_1.mp4", label:"v1"},
          {src:"examples/woman_40_walking_nyc/veo2_2.mp4", label:"v2"}
        ],
        score: "good",
        comment: "Good quality but slightly less natural than Veo 3. Some minor inconsistencies in background.",
        metrics: {
          instructionFollowing: 8.0,
          consistency: 7.5,
          realism: 8.4,
          animation: 7.8,
          creativity: 7.6
        }
      },
      {
        model:"Sora",
        variants:[
          {src:"examples/woman_40_walking_nyc/sora_1.mp4", label:"v1"},
          {src:"examples/woman_40_walking_nyc/sora_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Exceptional cinematic quality with great attention to lighting and atmosphere.",
        metrics: {
          instructionFollowing: 8.7,
          consistency: 8.5,
          realism: 9.1,
          animation: 8.6,
          creativity: 9.2
        }
      },
      {
        model:"Wan 2.1",
        src:"examples/woman_40_walking_nyc/wan21.webp",
        score: "poor",
        comment: "Static output instead of video. Limited animation capabilities.",
        metrics: {
          instructionFollowing: 7.2,
          consistency: 7.8,
          realism: 7.8,
          animation: 6.0,
          creativity: 7.0
        }
      },
      {
        model:"Kling 1.6",
        src:"examples/woman_40_walking_nyc/kling16.mp4",
        score: "good",
        comment: "Solid performance with good character consistency throughout the sequence.",
        metrics: {
          instructionFollowing: 8.1,
          consistency: 8.3,
          realism: 8.0,
          animation: 8.5,
          creativity: 7.7
        }
      },
      {
        model:"Kling 2.0",
        src:"examples/woman_40_walking_nyc/kling20.mp4",
        score: "good",
        comment: "Improved over 1.6 with better background detail and smoother motion.",
        metrics: {
          instructionFollowing: 8.5,
          consistency: 8.6,
          realism: 8.3,
          animation: 8.8,
          creativity: 8.0
        }
      },
      {
        model:"CogVideoX 1.5",
        src:"examples/woman_40_walking_nyc/cogvideox15.mp4",
        score: "good",
        comment: "Solid performance with good character consistency throughout the sequence.",
        metrics: {
          instructionFollowing: 7.8,
          consistency: 8.0,
          realism: 7.9,
          animation: 7.6,
          creativity: 7.5
        }
      },
      {
        model:"FramePack + HunYuan",
        src:"examples/woman_40_walking_nyc/HYFramepack.mp4",
        score: "good",
        comment: "Enhanced version shows significant improvement over base HunYuan model.",
        metrics: {
          instructionFollowing: 8.2,
          consistency: 8.7,
          realism: 8.0,
          animation: 7.8,
          creativity: 8.1
        }
      }
    ],
  },
  {
    prompt:"A nature scene with a blue hummingbird moving towards a flower then flying away",
    images:[
      {
        model:"Reference Image",
        src:"examples/humming_bird_flying/original.jpeg",
        score: "reference",
        comment: "Original reference image"
      },
      {
        model:"Veo 3",
        variants:[
          {src:"examples/humming_bird_flying/veo3_1.mp4", label:"v1"},
          {src:"examples/humming_bird_flying/veo3_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Stunning detail in wing movement and natural flight patterns. Beautiful color accuracy.",
        metrics: {
          instructionFollowing: 9.0,
          consistency: 8.8,
          realism: 8.9,
          animation: 9.2,
          creativity: 8.8
        }
      },
      {
        model:"Veo 2",
        variants:[
          {src:"examples/humming_bird_flying/veo2_1.mp4", label:"v1"},
          {src:"examples/humming_bird_flying/veo2_2.mp4", label:"v2"}
        ],
        score: "good",
        comment: "Good attempt at capturing rapid wing movement, though less refined than Veo 3.",
        metrics: {
          instructionFollowing: 8.2,
          consistency: 8.0,
          realism: 8.1,
          animation: 8.3,
          creativity: 7.9
        }
      },
      {
        model:"Sora",
        variants:[
          {src:"examples/humming_bird_flying/sora_1.mp4", label:"v1"},
          {src:"examples/humming_bird_flying/sora_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Exceptional biological accuracy and fluid motion. Great depth of field effects.",
        metrics: {
          instructionFollowing: 8.3,
          consistency: 8.1,
          realism: 8.5,
          animation: 8.2,
          creativity: 8.7
        }
      },
      {
        model:"Wan 2.1",
        src:"examples/humming_bird_flying/wan21.webp",
        score: "poor",
        comment: "Static result fails to show any movement. Not suitable for motion scenes.",
        metrics: {
          instructionFollowing: 7.8,
          consistency: 7.8,
          realism: 7.4,
          animation: 6.5,
          creativity: 7.2
        }
      },
      {
        model:"Kling 1.6",
        src:"examples/humming_bird_flying/kling16.mp4",
        score: "average",
        comment: "Decent bird animation but struggles with rapid wing movement physics.",
        metrics: {
          instructionFollowing: 7.7,
          consistency: 7.8,
          realism: 8.2,
          animation: 7.9,
          creativity: 7.9
        }
      },
      {
        model:"Kling 2.0",
        src:"examples/humming_bird_flying/kling20.mp4",
        score: "good",
        comment: "Notable improvement in wing detail and overall scene composition.",
        metrics: {
          instructionFollowing: 8.1,
          consistency: 8.2,
          realism: 8.7,
          animation: 8.4,
          creativity: 8.4
        }
      },
      {
        model:"CogVideoX 1.5",
        src:"examples/humming_bird_flying/cogvideox15.mp4",
        score: "good",
        comment: "Solid performance with good character consistency throughout the sequence.",
        metrics: {
          instructionFollowing: 7.6,
          consistency: 7.9,
          realism: 7.8,
          animation: 7.5,
          creativity: 7.7
        }
      },
      {
        model:"FramePack + HunYuan",
        src:"examples/humming_bird_flying/HYFramepack.mp4",
        score: "good",
        comment: "Enhanced motion quality shows the benefit of frame conditioning.",
        metrics: {
          instructionFollowing: 7.8,
          consistency: 8.3,
          realism: 8.2,
          animation: 8.0,
          creativity: 8.5
        }
      }
    ],
  },
  {
    prompt:"A first person view of a home chef chopping onions",
    images:[
      {
        model:"Reference Image",
        src:"examples/onions/original.jpeg",
        score: "reference",
        comment: "Original reference image"
      },
      {
        model:"Veo 3",
        variants:[
          {src:"examples/onions/veo3_1.mp4", label:"v1"},
          {src:"examples/onions/veo3_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Perfect hand-eye coordination and realistic knife handling. Great POV perspective.",
        metrics: {
          instructionFollowing: 9.0,
          consistency: 8.9,
          realism: 8.8,
          animation: 8.7,
          creativity: 8.9
        }
      },
      {
        model:"Veo 2",
        variants:[
          {src:"examples/onions/veo2_1.mp4", label:"v1"},
          {src:"examples/onions/veo2_2.mp4", label:"v2"}
        ],
        score: "good",
        comment: "Good chopping motion but hand positioning could be more natural.",
        metrics: {
          instructionFollowing: 8.0,
          consistency: 8.1,
          realism: 8.4,
          animation: 7.7,
          creativity: 7.9
        }
      },
      {
        model:"Sora",
        variants:[
          {src:"examples/onions/sora_1.mp4", label:"v1"},
          {src:"examples/onions/sora_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Excellent detail in food texture and cutting technique. Very convincing POV.",
        metrics: {
          instructionFollowing: 8.6,
          consistency: 8.4,
          realism: 8.9,
          animation: 8.5,
          creativity: 8.4
        }
      },
      {
        model:"Wan 2.1",
        src:"examples/onions/wan21.webp",
        score: "poor",
        comment: "No animation - completely static image output.",
        metrics: {
          instructionFollowing: 7.0,
          consistency: 7.8,
          realism: 7.8,
          animation: 5.8,
          creativity: 7.5
        }
      },
      {
        model:"Kling 1.6",
        src:"examples/onions/kling16.mp4",
        score: "average",
        comment: "Decent attempt but knife motion appears somewhat unnatural.",
        metrics: {
          instructionFollowing: 8.0,
          consistency: 7.9,
          realism: 8.0,
          animation: 8.3,
          creativity: 7.6
        }
      },
      {
        model:"Kling 2.0",
        src:"examples/onions/kling20.mp4",
        score: "good",
        comment: "Improved hand coordination and more realistic cutting rhythm.",
        metrics: {
          instructionFollowing: 8.4,
          consistency: 8.3,
          realism: 8.4,
          animation: 8.7,
          creativity: 8.1
        }
      },
      {
        model:"CogVideoX 1.5",
        src:"examples/onions/cogvideox15.mp4",
        score: "good",
        comment: "Improved hand coordination and more realistic cutting rhythm.",
        metrics: {
          instructionFollowing: 7.9,
          consistency: 8.1,
          realism: 7.7,
          animation: 7.8,
          creativity: 7.6
        }
      },
      {
        model:"FramePack + HunYuan",
        src:"examples/onions/HYFramepack.mp4",
        score: "good",
        comment: "Enhanced version shows better temporal consistency in cutting motion.",
        metrics: {
          instructionFollowing: 8.1,
          consistency: 8.6,
          realism: 8.2,
          animation: 8.1,
          creativity: 8.4
        }
      }
    ],
  },
  {
    prompt:"Anime red-haired girl dodging an arrow – the arrow narrowly misses her, flying left→right",
    images:[
      {
        model:"Reference Image",
        src:"examples/anime/original.jpeg",
        score: "reference",
        comment: "Original reference image"
      },
      {
        model:"Veo 3",
        variants:[
          {src:"examples/anime/veo3_1.mp4", label:"v1"},
          {src:"examples/anime/veo3_2.mp4", label:"v2"}
        ],
        score: "good",
        comment: "Good anime style adaptation but arrow trajectory could be clearer.",
        metrics: {
          instructionFollowing: 9.2,
          consistency: 8.8,
          realism: 8.5,
          animation: 8.4,
          creativity: 9.0
        }
      },
      {
        model:"Veo 2",
        variants:[
          {src:"examples/anime/veo2_1.mp4", label:"v1"},
          {src:"examples/anime/veo2_2.mp4", label:"v2"}
        ],
        score: "average",
        comment: "Struggles with anime style consistency. Motion is somewhat choppy.",
        metrics: {
          instructionFollowing: 8.2,
          consistency: 7.7,
          realism: 8.1,
          animation: 8.2,
          creativity: 7.8
        }
      },
      {
        model:"Sora",
        variants:[
          {src:"examples/anime/sora_1.mp4", label:"v1"},
          {src:"examples/anime/sora_2.mp4", label:"v2"}
        ],
        score: "excellent",
        comment: "Outstanding anime style rendering with fluid character animation.",
        metrics: {
          instructionFollowing: 8.4,
          consistency: 8.2,
          realism: 8.9,
          animation: 8.3,
          creativity: 8.7
        }
      },
      {
        model:"Kling 1.6",
        src:"examples/anime/kling16.mp4",
        score: "good",
        comment: "Nice anime aesthetics with good character movement dynamics.",
        metrics: {
          instructionFollowing: 7.8,
          consistency: 8.1,
          realism: 8.2,
          animation: 8.1,
          creativity: 8.0
        }
      },
      {
        model:"Kling 2.0",
        src:"examples/anime/kling20.mp4",
        score: "excellent",
        comment: "Exceptional anime style with perfect arrow physics and dodge timing.",
        metrics: {
          instructionFollowing: 8.2,
          consistency: 8.5,
          realism: 8.6,
          animation: 8.8,
          creativity: 8.3
        }
      },
      {
        model:"Wan 2.1",
        src:"examples/anime/wan21.webp",
        score: "poor",
        comment: "Static output - misses the entire point of the dynamic scene.",
        metrics: {
          instructionFollowing: 7.6,
          consistency: 7.8,
          realism: 7.2,
          animation: 6.2,
          creativity: 8.0
        }
      },
      {
        model:"CogVideoX 1.5",
        src:"examples/anime/cogvideox15.mp4",
        score: "good",
        comment: "Improved hand coordination and more realistic cutting rhythm.",
        metrics: {
          instructionFollowing: 7.7,
          consistency: 7.9,
          realism: 8.0,
          animation: 7.4,
          creativity: 7.8
        }
      },
      {
        model:"FramePack + HunYuan",
        src:"examples/anime/HYFramepack.mp4",
        score: "good",
        comment: "Solid anime interpretation with good character consistency.",
        metrics: {
          instructionFollowing: 7.9,
          consistency: 8.4,
          realism: 8.1,
          animation: 7.7,
          creativity: 8.2
        }
      }
    ],
  },
];

// T2V Examples (Text-to-Video without reference images)
const t2vExamples = [
  {
    prompt:"Realistic woman in mid 40s walking through a city street in New York",
    images:[
      {
        model:"Kling 2.0",
        src:"examples/woman_40_walking_nyc/kling20_t2v.mp4",
        score: "good",
        comment: "",
        metrics: {
          instructionFollowing: 8.4,
          consistency: 8.2,
          realism: 8.0,
          animation: 8.5,
          creativity: 8.7
        }
      },
      {
        model:"Kling 1.6",
        src: "examples/woman_40_walking_nyc/kling16_t2v.mp4",
        score: "good",
        comment: "",
        metrics: {
          instructionFollowing: 8.4,
          consistency: 8.2,
          realism: 8.0,
          animation: 8.5,
          creativity: 8.7
        }
      },
 
      {
        model:"CogVideoX 1.5",
        src:"examples/dragon_castle/cogvideox15.mp4",
        score: "average",
        comment: "Decent attempt but dragon movement appears less natural than other models.",
        metrics: {
          instructionFollowing: 7.8,
          consistency: 7.6,
          realism: 7.5,
          animation: 7.3,
          creativity: 8.0
        }
      }
    ],
  },
  {
    prompt:"A nature scene with a blue hummingbird moving towards a flower then flying away",
    images:[
      {
        model:"Kling 2.0",
        src:"examples/humming_bird_flying/kling20_t2v.mp4",
        score: "good",
        comment: "",
        metrics: {
          instructionFollowing: 8.2,
          consistency: 8.0,
          realism: 8.4,
          animation: 8.1,
          creativity: 7.9
        }
      },
      {
        model:"Kling 1.6",
        src:"examples/humming_bird_flying/kling16_t2v.mp4",
        score: "average",
        comment: "",
        metrics: {
          instructionFollowing: 7.6,
          consistency: 7.4,
          realism: 8.0,
          animation: 7.8,
          creativity: 7.7
        }
      }
    ],
  },
  {
    prompt:"A first person view of a home chef chopping onions",
    images:[
      {
        model:"Kling 2.0",
        src:"examples/onions/kling20_t2v.mp4",
        score: "good",
        comment: "",
        metrics: {
          instructionFollowing: 8.0,
          consistency: 7.9,
          realism: 7.8,
          animation: 8.2,
          creativity: 8.4
        }
      },
      {
        model:"Kling 1.6",
        src:"examples/onions/kling16_t2v.mp4",
        score: "average",
        comment: "",
        metrics: {
          instructionFollowing: 7.5,
          consistency: 7.7,
          realism: 7.3,
          animation: 7.4,
          creativity: 7.8
        }
      }
    ],
  }
];

/*───────────────────────────────────────────
 2)  APPLICATION CODE
───────────────────────────────────────────*/
class MediaShowdown{
  constructor(){
    this.i2vExamples = i2vExamples;
    this.t2vExamples = t2vExamples;
    this.currentTab = 'i2v';
    this.filteredI2V = [...i2vExamples];
    this.filteredT2V = [...t2vExamples];
    this.modal = document.getElementById('mediaModal');
    this.carousels = new Map();
    this.modalCarousel = null;
    this.init();
  }

  /* ── Init ── */
  init(){
    this.listeners();
    this.updateStats();
    this.buildScoringTable();
    this.buildNav();
    this.buildContent();
    this.updateTabCounts();
  }

  listeners(){
    /* tab switching */
    document.querySelectorAll('.tab-button').forEach(btn => {
      btn.addEventListener('click', (e) => this.switchTab(e.target.dataset.tab));
    });

    /* search */
    document.getElementById('searchInput')
      .addEventListener('input',(e)=>this.handleSearch(e.target.value));

    /* modal close */
    document.querySelector('.close')
      .addEventListener('click',()=>this.closeModal());
    this.modal.addEventListener('click',(e)=>{
      if(e.target===this.modal) this.closeModal();
    });
    document.addEventListener('keydown',(e)=>{
      if(e.key==='Escape') this.closeModal();
    });

    /* modal carousel controls */
    document.getElementById('modalPrevBtn')
      .addEventListener('click', () => this.modalCarouselPrev());
    document.getElementById('modalNextBtn')
      .addEventListener('click', () => this.modalCarouselNext());

    /* global error handling for thumbnails */
    document.addEventListener('error',(e)=>{
      if(e.target.tagName==='IMG'||e.target.tagName==='VIDEO'){
        this.handleError(e.target);
      }
    },true);
  }

  /* ── Tab Management ── */
  switchTab(tabName) {
    this.currentTab = tabName;
    
    // Update tab buttons
    document.querySelectorAll('.tab-button').forEach(btn => {
      btn.classList.toggle('active', btn.dataset.tab === tabName);
    });
    
    // Update tab content
    document.querySelectorAll('.tab-content').forEach(content => {
      content.classList.toggle('active', content.id === `${tabName}-content`);
    });
    
    // Update navigation and content for current tab
    this.updateNav();
    this.toggleNoResults();
  }

  updateTabCounts() {
    document.getElementById('i2vCount').textContent = this.i2vExamples.length;
    document.getElementById('t2vCount').textContent = this.t2vExamples.length;
  }

  getCurrentExamples() {
    return this.currentTab === 'i2v' ? this.filteredI2V : this.filteredT2V;
  }

  getAllCurrentExamples() {
    return this.currentTab === 'i2v' ? this.i2vExamples : this.t2vExamples;
  }

  slugify(txt){return txt.toLowerCase()
        .replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');}

  /* ── Statistics ── */
  updateStats(){
    const totalI2V = this.i2vExamples.length;
    const totalT2V = this.t2vExamples.length;
    const totalPrompts = totalI2V + totalT2V;
    
    let totalMedia = 0;
    const models = new Set();
    
    [...this.i2vExamples, ...this.t2vExamples].forEach(ex=>{
      ex.images.forEach(img=>{
        if(img.variants) {
          totalMedia += img.variants.length;
          models.add(img.model);
        } else if (img.model !== "Reference Image") {
          totalMedia += 1;
          models.add(img.model);
        }
      });
    });

    document.getElementById('totalPrompts').textContent = totalPrompts;
    document.getElementById('totalMedia').textContent = totalMedia;
    document.getElementById('totalModels').textContent = models.size;
  }

  /* ── Scoring Table ── */
  getScoreClass(score) {
    if (score >= 8.5) return 'excellent';
    if (score >= 7.5) return 'good';
    if (score >= 6.5) return 'average';
    return 'poor';
  }

  formatScore(score) {
    return score.toFixed(1);
  }

  buildScoringTable() {
    this.currentSort = { column: 'average', direction: 'desc' };
    this.sortedModels = Object.entries(modelScores);
    
    // Add click handlers to headers
    this.addSortingHandlers();
    
    // Initial render
    this.renderSortedTable();
  }

  addSortingHandlers() {
    const headers = document.querySelectorAll('#scoringTable th');
    const sortableColumns = [
      { index: 0, key: 'model', type: 'string' },
      { index: 1, key: 'instructionFollowing', type: 'number' },
      { index: 2, key: 'consistency', type: 'number' },
      { index: 3, key: 'realism', type: 'number' },
      { index: 4, key: 'animation', type: 'number' },
      { index: 5, key: 'creativity', type: 'number' },
      { index: 6, key: 'average', type: 'number' }
    ];

    sortableColumns.forEach(({ index, key, type }) => {
      const header = headers[index];
      header.classList.add('sortable');
      header.style.cursor = 'pointer';
      
      // Add sort indicator
      const indicator = document.createElement('span');
      indicator.className = 'sort-indicator';
      indicator.innerHTML = '▼';
      header.appendChild(indicator);
      
      // Set initial sort state for average column
      if (key === 'average') {
        header.classList.add('sort-desc');
      }
      
      header.addEventListener('click', () => {
        this.sortTable(key, type, header);
      });
    });
  }

  sortTable(column, type, headerElement) {
    // Update sort direction
    const currentDirection = this.currentSort.column === column ? this.currentSort.direction : 'desc';
    const newDirection = currentDirection === 'asc' ? 'desc' : 'asc';
    
    this.currentSort = { column, direction: newDirection };
    
    // Update header indicators
    document.querySelectorAll('#scoringTable th').forEach(h => {
      h.classList.remove('sort-asc', 'sort-desc');
    });
    headerElement.classList.add(`sort-${newDirection}`);
    
    // Sort the data
    this.sortedModels.sort((a, b) => {
      let valueA, valueB;
      
      if (column === 'model') {
        valueA = a[0];
        valueB = b[0];
      } else if (column === 'average') {
        valueA = Object.values(a[1]).reduce((sum, score) => sum + score, 0) / Object.values(a[1]).length;
        valueB = Object.values(b[1]).reduce((sum, score) => sum + score, 0) / Object.values(b[1]).length;
      } else {
        valueA = a[1][column];
        valueB = b[1][column];
      }
      
      if (type === 'string') {
        const comparison = valueA.localeCompare(valueB);
        return newDirection === 'asc' ? comparison : -comparison;
      } else {
        return newDirection === 'asc' ? valueA - valueB : valueB - valueA;
      }
    });
    
    this.renderSortedTable();
  }

  renderSortedTable() {
    const tbody = document.getElementById('scoringTableBody');
    tbody.innerHTML = '';

    this.sortedModels.forEach(([modelName, scores]) => {
      const average = Object.values(scores).reduce((sum, score) => sum + score, 0) / Object.values(scores).length;

      const row = document.createElement('tr');
      row.innerHTML = `
        <td class="model-name">${modelName}</td>
        <td class="score-cell">
          <div class="score-${this.getScoreClass(scores.instructionFollowing)}">${this.formatScore(scores.instructionFollowing)}</div>
          <div class="score-bar"><div class="score-fill ${this.getScoreClass(scores.instructionFollowing)}" style="width: ${scores.instructionFollowing * 10}%"></div></div>
        </td>
        <td class="score-cell">
          <div class="score-${this.getScoreClass(scores.consistency)}">${this.formatScore(scores.consistency)}</div>
          <div class="score-bar"><div class="score-fill ${this.getScoreClass(scores.consistency)}" style="width: ${scores.consistency * 10}%"></div></div>
        </td>
        <td class="score-cell">
          <div class="score-${this.getScoreClass(scores.realism)}">${this.formatScore(scores.realism)}</div>
          <div class="score-bar"><div class="score-fill ${this.getScoreClass(scores.realism)}" style="width: ${scores.realism * 10}%"></div></div>
        </td>
        <td class="score-cell">
          <div class="score-${this.getScoreClass(scores.animation)}">${this.formatScore(scores.animation)}</div>
          <div class="score-bar"><div class="score-fill ${this.getScoreClass(scores.animation)}" style="width: ${scores.animation * 10}%"></div></div>
        </td>
        <td class="score-cell">
          <div class="score-${this.getScoreClass(scores.creativity)}">${this.formatScore(scores.creativity)}</div>
          <div class="score-bar"><div class="score-fill ${this.getScoreClass(scores.creativity)}" style="width: ${scores.creativity * 10}%"></div></div>
        </td>
        <td class="score-cell average-cell">
          <div class="score-${this.getScoreClass(average)}">${this.formatScore(average)}</div>
          <div class="score-bar"><div class="score-fill ${this.getScoreClass(average)}" style="width: ${average * 10}%"></div></div>
        </td>
      `;
      tbody.appendChild(row);
    });
  }

  /* ── Search ── */
  handleSearch(query){
    const term = query.toLowerCase().trim();
    
    this.filteredI2V = term ? this.i2vExamples.filter(ex =>
      ex.prompt.toLowerCase().includes(term) ||
      ex.images.some(m=>m.model.toLowerCase().includes(term))
    ) : [...this.i2vExamples];
    
    this.filteredT2V = term ? this.t2vExamples.filter(ex =>
      ex.prompt.toLowerCase().includes(term) ||
      ex.images.some(m=>m.model.toLowerCase().includes(term))
    ) : [...this.t2vExamples];

    this.updateNav();
    this.updateContent();
    this.toggleNoResults();
  }

  updateNav(){
    document.querySelectorAll('nav a').forEach(link=>{
      const id = link.getAttribute('href').slice(1);
      const visible = this.getCurrentExamples().some(ex=>this.slugify(ex.prompt)===id);
      link.classList.toggle('hidden',!visible);
    });
  }

  updateContent(){
    const currentContainer = this.currentTab === 'i2v' ? 'i2v-examples' : 't2v-examples';
    document.querySelectorAll(`#${currentContainer} section`).forEach(sec=>{
      const visible = this.getCurrentExamples().some(ex=>this.slugify(ex.prompt)===sec.id);
      sec.classList.toggle('hidden',!visible);
    });
  }

  toggleNoResults(){
    const noResultsId = this.currentTab === 'i2v' ? 'i2vNoResults' : 't2vNoResults';
    document.getElementById(noResultsId)
      .classList.toggle('visible', this.getCurrentExamples().length === 0);
  }

  /* ── Navigation build ── */
  buildNav(){
    const nav = document.getElementById('nav');
    
    // Clear existing nav
    nav.innerHTML = '';
    
    // Add I2V examples
    this.i2vExamples.forEach(ex=>{
      const a = document.createElement('a');
      a.href = '#' + this.slugify(ex.prompt);
      a.textContent = ex.prompt.length > 50 ? ex.prompt.slice(0,47) + '…' : ex.prompt;
      a.setAttribute('aria-label',`Jump to I2V: ${ex.prompt}`);
      a.style.borderLeft = '3px solid #3b82f6'; // Blue for I2V
      nav.appendChild(a);
    });
    
    // Add T2V examples
    this.t2vExamples.forEach(ex=>{
      const a = document.createElement('a');
      a.href = '#' + this.slugify(ex.prompt);
      a.textContent = ex.prompt.length > 50 ? ex.prompt.slice(0,47) + '…' : ex.prompt;
      a.setAttribute('aria-label',`Jump to T2V: ${ex.prompt}`);
      a.style.borderLeft = '3px solid #10b981'; // Green for T2V
      nav.appendChild(a);
    });
    
    // Initial nav visibility update
    this.updateNav();
  }

  /* ── Carousel Management ── */
  createCarousel(carouselId, variants, container) {
    const carousel = {
      id: carouselId,
      variants: variants,
      currentIndex: 0,
      container: container
    };

    this.carousels.set(carouselId, carousel);
    return carousel;
  }

  updateCarousel(carouselId, newIndex) {
    const carousel = this.carousels.get(carouselId);
    if (!carousel) return;

    // Update slides
    const slides = carousel.container.querySelectorAll('.carousel-slide');
    slides.forEach((slide, index) => {
      slide.classList.toggle('active', index === newIndex);
    });

    // Update dots
    const dots = carousel.container.querySelectorAll('.carousel-dot');
    dots.forEach((dot, index) => {
      dot.classList.toggle('active', index === newIndex);
    });

    // Update arrows
    const prevBtn = carousel.container.querySelector('.carousel-arrow:first-child');
    const nextBtn = carousel.container.querySelector('.carousel-arrow:last-child');
    if (prevBtn) prevBtn.disabled = newIndex === 0;
    if (nextBtn) nextBtn.disabled = newIndex === carousel.variants.length - 1;

    carousel.currentIndex = newIndex;
  }

  /* ── Metrics Toggle Functions ── */
  createMetricsSection(modelName) {
    const scores = modelScores[modelName];
    if (!scores) return '';

    const metricLabels = {
      instructionFollowing: 'Instruction Following',
      consistency: 'Consistency',
      realism: 'Realism',
      animation: 'Animation Quality',
      creativity: 'Creativity'
    };

    const metricsHtml = Object.entries(scores).map(([key, value]) => {
      const scoreClass = this.getScoreClass(value);
      return `
        <div class="metric-item">
          <span class="metric-name">${metricLabels[key]}</span>
          <div class="metric-score">
            <span class="metric-value score-${scoreClass}">${this.formatScore(value)}</span>
            <div class="metric-bar">
              <div class="metric-bar-fill score-fill ${scoreClass}" style="width: ${value * 10}%"></div>
            </div>
          </div>
        </div>
      `;
    }).join('');

    return `
      <div class="metrics-toggle" onclick="this.parentElement.toggleMetrics(this)">
        <div class="metrics-toggle-text">
          <div class="bar-chart-icon">
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
            <div class="bar"></div>
          </div>
          <span>Detailed Metrics</span>
        </div>
        <div class="toggle-arrow">▼</div>
      </div>
      <div class="metrics-details">
        ${metricsHtml}
      </div>
    `;
  }

  /* ── Content build ── */
  buildContent(){
    this.buildI2VContent();
    this.buildT2VContent();
  }

  buildI2VContent() {
    const container = document.getElementById('i2v-examples');
    container.innerHTML = '';
    
    this.i2vExamples.forEach((ex, i) => {
      const sec = document.createElement('section');
      sec.id = this.slugify(ex.prompt);
      sec.style.animationDelay = `${i * 0.1}s`;

      const h = document.createElement('h2');
      h.textContent = ex.prompt;
      sec.appendChild(h);
      
      const grid = document.createElement('div');
      grid.className = 'grid i2v'; // Add i2v class for reference image styling

      ex.images.forEach((img, idx) => {
        const fig = document.createElement('figure');

        /* detect reference image */
        const isRef = /reference/i.test(img.model) || img.model === 'Reference Image';
        if (isRef) fig.classList.add('reference');

        fig.tabIndex = 0;
        fig.role = 'button';
        fig.setAttribute('aria-label', `View ${img.model} media for: ${ex.prompt}`);

        const container = document.createElement('div');
        container.className = 'image-container';

        // Create the media content
        if (img.variants && img.variants.length > 1) {
          this.createCarouselStructure(container, img, ex.prompt);
        } else {
          this.createSingleMedia(container, img.variants ? img.variants[0] : img, img.model, ex.prompt);
        }

        fig.appendChild(container);

        const cap = document.createElement('figcaption');
        cap.textContent = img.model;
        fig.appendChild(cap);

        // Add scoring section
        if (img.score !== 'reference') {
          const scoring = document.createElement('div');
          scoring.className = 'card-scoring';
          
          const badge = document.createElement('div');
          badge.className = `score-badge score-${img.score}`;
          badge.textContent = img.score.toUpperCase();
          
          const comment = document.createElement('div');
          comment.className = 'score-comment';
          comment.textContent = img.comment;
          
          scoring.appendChild(badge);
          scoring.appendChild(comment);

          // Add metrics section if model has scores
          if (modelScores[img.model]) {
            const metricsHtml = this.createMetricsSection(img.model);
            scoring.innerHTML += metricsHtml;

            // Add toggle functionality
            scoring.toggleMetrics = function(toggleElement) {
              const detailsElement = toggleElement.nextElementSibling;
              const isExpanded = toggleElement.classList.contains('expanded');
              
              if (isExpanded) {
                toggleElement.classList.remove('expanded');
                detailsElement.classList.remove('expanded');
              } else {
                toggleElement.classList.add('expanded');
                detailsElement.classList.add('expanded');
              }
            };
          }
          
          fig.appendChild(scoring);
        } else {
          // Add invisible placeholder for reference images
          const placeholder = document.createElement('div');
          placeholder.className = 'card-scoring-placeholder';
          fig.appendChild(placeholder);
        }

        /* Modal handlers */
        if (img.variants && img.variants.length > 1) {
          fig.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              this.openModal(img, ex.prompt);
            }
          });
        } else {
          fig.addEventListener('click', (e) => {
            if (!e.target.closest('.metrics-toggle')) {
              this.openModal(img, ex.prompt);
            }
          });
          fig.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              this.openModal(img, ex.prompt);
            }
          });
        }

        grid.appendChild(fig);
      });

      sec.appendChild(grid);
      container.appendChild(sec);
    });
  }

  buildT2VContent() {
    const container = document.getElementById('t2v-examples');
    container.innerHTML = '';
    
    this.t2vExamples.forEach((ex, i) => {
      const sec = document.createElement('section');
      sec.id = this.slugify(ex.prompt);
      sec.style.animationDelay = `${i * 0.1}s`;

      const h = document.createElement('h2');
      h.textContent = ex.prompt;
      sec.appendChild(h);
      
      const grid = document.createElement('div');
      grid.className = 'grid'; // Regular grid for T2V (no reference image)

      ex.images.forEach((img, idx) => {
        const fig = document.createElement('figure');

        fig.tabIndex = 0;
        fig.role = 'button';
        fig.setAttribute('aria-label', `View ${img.model} media for: ${ex.prompt}`);

        const container = document.createElement('div');
        container.className = 'image-container';

        // Create the media content
        if (img.variants && img.variants.length > 1) {
          this.createCarouselStructure(container, img, ex.prompt);
        } else {
          this.createSingleMedia(container, img.variants ? img.variants[0] : img, img.model, ex.prompt);
        }

        fig.appendChild(container);

        const cap = document.createElement('figcaption');
        cap.textContent = img.model;
        fig.appendChild(cap);

        // Add scoring section (all T2V examples have scores since no reference)
        const scoring = document.createElement('div');
        scoring.className = 'card-scoring';
        
        const badge = document.createElement('div');
        badge.className = `score-badge score-${img.score}`;
        badge.textContent = img.score.toUpperCase();
        
        const comment = document.createElement('div');
        comment.className = 'score-comment';
        comment.textContent = img.comment;
        
        scoring.appendChild(badge);
        scoring.appendChild(comment);

        // Add metrics section if model has scores
        if (modelScores[img.model]) {
          const metricsHtml = this.createMetricsSection(img.model);
          scoring.innerHTML += metricsHtml;

          // Add toggle functionality
          scoring.toggleMetrics = function(toggleElement) {
            const detailsElement = toggleElement.nextElementSibling;
            const isExpanded = toggleElement.classList.contains('expanded');
            
            if (isExpanded) {
              toggleElement.classList.remove('expanded');
              detailsElement.classList.remove('expanded');
            } else {
              toggleElement.classList.add('expanded');
              detailsElement.classList.add('expanded');
            }
          };
        }
        
        fig.appendChild(scoring);

        /* Modal handlers */
        if (img.variants && img.variants.length > 1) {
          fig.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              this.openModal(img, ex.prompt);
            }
          });
        } else {
          fig.addEventListener('click', (e) => {
            if (!e.target.closest('.metrics-toggle')) {
              this.openModal(img, ex.prompt);
            }
          });
          fig.addEventListener('keydown', e => {
            if (e.key === 'Enter' || e.key === ' ') {
              e.preventDefault();
              this.openModal(img, ex.prompt);
            }
          });
        }

        grid.appendChild(fig);
      });

      sec.appendChild(grid);
      container.appendChild(sec);
    });
  }

  createCarouselStructure(container, img, prompt) {
    const carouselId = `carousel-${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
    
    const carouselContainer = document.createElement('div');
    carouselContainer.className = 'carousel-container';

    const slides = document.createElement('div');
    slides.className = 'carousel-slides';

    // Create slides
    img.variants.forEach((variant, index) => {
      const slide = document.createElement('div');
      slide.className = `carousel-slide ${index === 0 ? 'active' : ''}`;
      
      this.createSingleMedia(slide, variant, `${img.model} (${variant.label})`, prompt);
      slides.appendChild(slide);
    });

    // Create navigation dots
    const nav = document.createElement('div');
    nav.className = 'carousel-nav';
    img.variants.forEach((_, index) => {
      const dot = document.createElement('div');
      dot.className = `carousel-dot ${index === 0 ? 'active' : ''}`;
      dot.addEventListener('click', (e) => {
        e.stopPropagation();
        this.updateCarousel(carouselId, index);
      });
      nav.appendChild(dot);
    });

    // Create arrow navigation
    const arrows = document.createElement('div');
    arrows.className = 'carousel-arrows';
    
    const prevBtn = document.createElement('button');
    prevBtn.className = 'carousel-arrow';
    prevBtn.innerHTML = '‹';
    prevBtn.disabled = true;
    prevBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      const carousel = this.carousels.get(carouselId);
      if (carousel && carousel.currentIndex > 0) {
        this.updateCarousel(carouselId, carousel.currentIndex - 1);
      }
    });

    const nextBtn = document.createElement('button');
    nextBtn.className = 'carousel-arrow';
    nextBtn.innerHTML = '›';
    nextBtn.disabled = img.variants.length <= 1;
    nextBtn.addEventListener('click', (e) => {
      e.stopPropagation();
      const carousel = this.carousels.get(carouselId);
      if (carousel && carousel.currentIndex < carousel.variants.length - 1) {
        this.updateCarousel(carouselId, carousel.currentIndex + 1);
      }
    });

    arrows.appendChild(prevBtn);
    arrows.appendChild(nextBtn);

    carouselContainer.appendChild(slides);
    carouselContainer.appendChild(arrows);
    carouselContainer.appendChild(nav);
    
    container.appendChild(carouselContainer);

    // Initialize carousel state
    this.createCarousel(carouselId, img.variants, carouselContainer);

    // Add click handler to the media content area for modal opening
    slides.addEventListener('click', (e) => {
      if (!e.target.closest('.carousel-nav') && !e.target.closest('.carousel-arrows')) {
        const carousel = this.carousels.get(carouselId);
        if (carousel) {
          const modalData = {
            model: img.model,
            variants: img.variants,
            score: img.score,
            comment: img.comment
          };
          this.openModal(modalData, prompt);
        }
      }
    });
  }

  createSingleMedia(container, mediaData, modelName, prompt) {
    const load = document.createElement('div');
    load.className = 'loading-placeholder';
    load.innerHTML = '<div class="loading-spinner"></div>Loading…';
    container.appendChild(load);

    const src = mediaData.src || mediaData;
    const isVideo = /\.(mp4|webm|mov)$/i.test(src);
    let mediaEl;

    if (isVideo) {
      mediaEl = document.createElement('video');
      mediaEl.src = src;
      mediaEl.muted = true;
      mediaEl.playsInline = true;
      mediaEl.loop = true;
      mediaEl.autoplay = true;
      mediaEl.style.display = 'none';
      mediaEl.addEventListener('loadeddata', () => {
        load.remove();
        mediaEl.style.display = 'block';
      });
    } else {
      mediaEl = document.createElement('img');
      mediaEl.src = src;
      mediaEl.alt = `${modelName} – ${prompt}`;
      mediaEl.style.display = 'none';
      mediaEl.onload = () => {
        load.remove();
        mediaEl.style.display = 'block';
      };
    }

    container.appendChild(mediaEl);
  }

  /* ── Error placeholder ── */
  handleError(el) {
    const cont = el.closest('.image-container');
    const load = cont.querySelector('.loading-placeholder');
    if (load) {
      load.textContent = '❌ Failed to load';
      load.classList.add('error-placeholder');
    }
    el.style.display = 'none';
  }

  /* ── Modal ── */
  openModal(imgData, prompt) {
    const modalSlides = document.getElementById('modalCarouselSlides');
    const modalNav = document.getElementById('modalCarouselNav');
    const modalCaption = document.getElementById('modalCaption');
    const modalArrows = document.querySelector('.modal-carousel-arrows');

    // Clear previous content
    modalSlides.innerHTML = '';
    modalNav.innerHTML = '';

    if (imgData.variants && imgData.variants.length > 1) {
      // Multi-variant carousel
      this.modalCarousel = {
        variants: imgData.variants,
        currentIndex: 0,
        model: imgData.model,
        prompt: prompt
      };

      // Show navigation
      modalNav.style.display = 'flex';
      modalArrows.style.display = 'flex';

      // Create slides
      imgData.variants.forEach((variant, index) => {
        const slide = document.createElement('div');
        slide.className = `carousel-slide ${index === 0 ? 'active' : ''}`;
        slide.style.position = 'absolute';
        slide.style.top = '0';
        slide.style.left = '0';
        slide.style.width = '100%';
        slide.style.height = '100%';
        slide.style.display = 'flex';
        slide.style.alignItems = 'center';
        slide.style.justifyContent = 'center';

        const src = variant.src;
        const isVideo = /\.(mp4|webm|mov)$/i.test(src);

        if (isVideo) {
          const video = document.createElement('video');
          video.src = src;
          video.controls = true;
          video.playsInline = true;
          video.style.maxWidth = '100%';
          video.style.maxHeight = '80vh';
          video.style.borderRadius = '12px';
          video.style.backgroundColor = '#000';
          slide.appendChild(video);
          
          if (index === 0) {
            video.play().catch(() => {});
          }
        } else {
          const img = document.createElement('img');
          img.src = src;
          img.alt = `${imgData.model} (${variant.label}) – ${prompt}`;
          img.style.maxWidth = '100%';
          img.style.maxHeight = '80vh';
          img.style.objectFit = 'contain';
          img.style.borderRadius = '12px';
          slide.appendChild(img);
        }

        modalSlides.appendChild(slide);
      });

      // Create navigation dots
      imgData.variants.forEach((variant, index) => {
        const dot = document.createElement('div');
        dot.className = `modal-carousel-dot ${index === 0 ? 'active' : ''}`;
        dot.addEventListener('click', () => this.updateModalCarousel(index));
        modalNav.appendChild(dot);
      });

      // Update arrow states
      document.getElementById('modalPrevBtn').disabled = true;
      document.getElementById('modalNextBtn').disabled = imgData.variants.length <= 1;

      // Set initial caption
      modalCaption.textContent = `${imgData.model} (${imgData.variants[0].label}) – ${prompt}`;

    } else {
      // Single item
      this.modalCarousel = null;
      
      // Hide navigation
      modalNav.style.display = 'none';
      modalArrows.style.display = 'none';
      
      const slide = document.createElement('div');
      slide.className = 'carousel-slide active';
      slide.style.position = 'relative';
      slide.style.width = '100%';
      slide.style.height = '100%';
      slide.style.display = 'flex';
      slide.style.alignItems = 'center';
      slide.style.justifyContent = 'center';

      const src = imgData.variants ? imgData.variants[0].src : imgData.src;
      const isVideo = /\.(mp4|webm|mov)$/i.test(src);

      if (isVideo) {
        const video = document.createElement('video');
        video.src = src;
        video.controls = true;
        video.playsInline = true;
        video.style.maxWidth = '100%';
        video.style.maxHeight = '80vh';
        video.style.borderRadius = '12px';
        video.style.backgroundColor = '#000';
        slide.appendChild(video);
        video.play().catch(() => {});
      } else {
        const img = document.createElement('img');
        img.src = src;
        img.alt = `${imgData.model} – ${prompt}`;
        img.style.maxWidth = '100%';
        img.style.maxHeight = '80vh';
        img.style.objectFit = 'contain';
        img.style.borderRadius = '12px';
        slide.appendChild(img);
      }

      modalSlides.appendChild(slide);
      modalCaption.textContent = `${imgData.model} – ${prompt}`;
    }

    // Show modal
    this.modal.classList.add('active');
    this.modal.setAttribute('aria-hidden', 'false');
    
    // Focus management
    setTimeout(() => {
      const firstVideo = this.modal.querySelector('video');
      if (firstVideo) {
        firstVideo.focus();
      } else {
        this.modal.focus();
      }
    }, 100);
  }

  updateModalCarousel(newIndex) {
    if (!this.modalCarousel) return;

    const slides = document.querySelectorAll('#modalCarouselSlides .carousel-slide');
    const dots = document.querySelectorAll('.modal-carousel-dot');

    // Pause all videos first
    slides.forEach(slide => {
      const video = slide.querySelector('video');
      if (video) {
        video.pause();
      }
    });

    // Update active states
    slides.forEach((slide, index) => {
      slide.classList.toggle('active', index === newIndex);
      if (index === newIndex) {
        const video = slide.querySelector('video');
        if (video) {
          video.play().catch(() => {});
        }
      }
    });

    dots.forEach((dot, index) => {
      dot.classList.toggle('active', index === newIndex);
    });

    // Update arrows
    document.getElementById('modalPrevBtn').disabled = newIndex === 0;
    document.getElementById('modalNextBtn').disabled = newIndex === this.modalCarousel.variants.length - 1;

    // Update caption
    const modalCaption = document.getElementById('modalCaption');
    const variant = this.modalCarousel.variants[newIndex];
    modalCaption.textContent = `${this.modalCarousel.model} (${variant.label}) – ${this.modalCarousel.prompt}`;

    this.modalCarousel.currentIndex = newIndex;
  }

  modalCarouselPrev() {
    if (this.modalCarousel && this.modalCarousel.currentIndex > 0) {
      this.updateModalCarousel(this.modalCarousel.currentIndex - 1);
    }
  }

  modalCarouselNext() {
    if (this.modalCarousel && this.modalCarousel.currentIndex < this.modalCarousel.variants.length - 1) {
      this.updateModalCarousel(this.modalCarousel.currentIndex + 1);
    }
  }

  closeModal() {
    this.modal.classList.remove('active');
    this.modal.setAttribute('aria-hidden', 'true');
    
    // Pause all videos
    const videos = this.modal.querySelectorAll('video');
    videos.forEach(video => {
      video.pause();
      video.currentTime = 0;
    });
    
    // Show navigation elements (they might have been hidden)
    const modalNav = document.getElementById('modalCarouselNav');
    const modalArrows = document.querySelector('.modal-carousel-arrows');
    if(modalNav) modalNav.style.display = 'flex';
    if(modalArrows) modalArrows.style.display = 'flex';
    
    this.modalCarousel = null;
  }
}

/* ── Init ── */
document.addEventListener('DOMContentLoaded',()=>new MediaShowdown());
</script>
</body>
</html>
